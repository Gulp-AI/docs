---
title: "AWS Integration"
description: "Configure AWS sources and sinks in Gulp"
---

# AWS Integration

Gulp provides native integration with AWS services for both sources and sinks. When running in AWS environments, authentication is handled automatically through IAM roles.

## Sources

### Amazon Kinesis

```yaml
source:
  type: "kinesis"
  config:
    stream: "my-data-stream"
    region: "us-west-2"
    initialPosition: "LATEST"  # LATEST, TRIM_HORIZON, AT_TIMESTAMP
    enhancedFanOut: true
    monitoring:
      enabled: true
      metrics: ["latency", "throughput", "errors"]
    watermark:
      timestampField: "event_time"
      maxOutOfOrderness: "5s"
```

### Amazon MSK (Managed Streaming for Kafka)

```yaml
source:
  type: "msk"
  config:
    bootstrapServers: "${MSK_BOOTSTRAP_SERVERS}"
    topics: ["my-topic"]
    groupId: "my-consumer-group"
    securityProtocol: "SASL_SSL"
    saslMechanism: "AWS_MSK_IAM"
    isolation: "read_committed"
    monitoring:
      enabled: true
      metrics: ["lag", "throughput", "errors"]
    watermark:
      timestampField: "event_time"
      maxOutOfOrderness: "5s"
```

### Amazon S3

```yaml
source:
  type: "s3"
  config:
    bucket: "my-data-bucket"
    path: "input/data/*.parquet"
    format: "parquet"  # parquet, json, csv, avro
    region: "us-west-2"
    maxConcurrentRequests: 10
    monitoring:
      enabled: true
      metrics: ["latency", "throughput", "errors"]
    checkpointing:
      enabled: true
      interval: "1m"
```

### Amazon DynamoDB Streams

```yaml
source:
  type: "dynamodb-streams"
  config:
    tableName: "my-table"
    region: "us-west-2"
    initialPosition: "LATEST"
    monitoring:
      enabled: true
      metrics: ["latency", "throughput", "errors"]
    watermark:
      timestampField: "ApproximateCreationDateTime"
      maxOutOfOrderness: "1s"
```

## Sinks

### Amazon Kinesis

```yaml
sink:
  type: "kinesis"
  config:
    stream: "my-output-stream"
    region: "us-west-2"
    partitionKey: "user_id"
    aggregation: true
    failOnErrors: true
    monitoring:
      enabled: true
      metrics: ["latency", "throughput", "errors"]
```

### Amazon MSK

```yaml
sink:
  type: "msk"
  config:
    bootstrapServers: "${MSK_BOOTSTRAP_SERVERS}"
    topic: "my-output-topic"
    securityProtocol: "SASL_SSL"
    saslMechanism: "AWS_MSK_IAM"
    delivery: "exactly_once"
    transaction:
      timeout: "15m"
      maxAttempts: 3
```

### Amazon S3

```yaml
sink:
  type: "s3"
  config:
    bucket: "my-output-bucket"
    path: "output/data"
    format: "parquet"
    partitioning:
      - field: "year"
        extractFromTimestamp: "event_time"
      - field: "month"
        extractFromTimestamp: "event_time"
    compression: "snappy"
    maxFileSize: "128mb"
    inactivityInterval: "5m"
```

### Amazon Redshift

```yaml
sink:
  type: "redshift"
  config:
    cluster: "my-redshift-cluster"
    database: "my_database"
    table: "my_table"
    region: "us-west-2"
    loadMethod: "copy"  # copy, insert
    staging:
      bucket: "my-staging-bucket"
      path: "redshift-staging"
    batchSize: "1000"
    monitoring:
      enabled: true
      metrics: ["latency", "throughput", "errors"]
```

### Amazon OpenSearch

```yaml
sink:
  type: "opensearch"
  config:
    domain: "my-domain"
    region: "us-west-2"
    index: "my-index"
    type: "_doc"
    bulkSize: 1000
    flushInterval: "1s"
    retries: 3
    monitoring:
      enabled: true
      metrics: ["latency", "throughput", "errors"]
```

## Authentication

When running in AWS environments, authentication is handled automatically through IAM roles. No explicit credentials need to be specified in the YAML configuration.

### Required IAM Permissions

Each service requires specific IAM permissions. Here are the common ones:

<CodeGroup>
```json Kinesis
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "kinesis:GetShardIterator",
        "kinesis:GetRecords",
        "kinesis:DescribeStream",
        "kinesis:PutRecord",
        "kinesis:PutRecords"
      ],
      "Resource": "arn:aws:kinesis:*:*:stream/*"
    }
  ]
}
```

```json MSK
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "kafka-cluster:Connect",
        "kafka-cluster:DescribeGroup",
        "kafka-cluster:AlterGroup",
        "kafka-cluster:DescribeTopic",
        "kafka-cluster:ReadData",
        "kafka-cluster:WriteData"
      ],
      "Resource": "arn:aws:kafka:*:*:*"
    }
  ]
}
```

```json S3
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "s3:GetObject",
        "s3:PutObject",
        "s3:ListBucket"
      ],
      "Resource": [
        "arn:aws:s3:::my-bucket",
        "arn:aws:s3:::my-bucket/*"
      ]
    }
  ]
}
```
</CodeGroup>

## Best Practices

1. **IAM Roles**: Use the principle of least privilege when configuring IAM roles
2. **VPC Endpoints**: Use VPC endpoints for improved security and reduced costs
3. **Enhanced Fan-Out**: Enable for Kinesis consumers that need dedicated throughput
4. **Batching**: Configure appropriate batch sizes for optimal performance
5. **Monitoring**: Enable CloudWatch metrics integration for all connectors

## Error Handling

All AWS connectors support consistent error handling configuration:

```yaml
errorHandling:
  retries:
    maxAttempts: 3
    backoffPeriod: "1s"
    maxBackoffPeriod: "1m"
    multiplier: 2.0
  deadLetter:
    enabled: true
    destination: "s3://my-bucket/dead-letter"
```

## Monitoring

Enable detailed monitoring with CloudWatch integration:

```yaml
monitoring:
  metrics:
    - name: "throughput"
      interval: "1m"
    - name: "latency"
      interval: "1m"
    - name: "errors"
      interval: "1m"
  alerts:
    - name: "HighLatency"
      threshold: "5s"
      duration: "5m"
    - name: "HighErrorRate"
      threshold: 0.01
      duration: "5m"
```

<Note>
For production deployments, it's recommended to enable monitoring and configure appropriate alerts.
</Note> 