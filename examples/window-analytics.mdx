---
title: "Window Analytics"
description: "Implementing windowed analytics with Gulp"
---

# Window Analytics Example

This example demonstrates how to implement windowed analytics using Gulp.

## User Session Analysis

```yaml
name: "User Session Analytics"
version: "1.0.0"

watermarkConfig:
  timeCharacteristic: EVENT_TIME
  timestampField: event_time
  maxOutOfOrderness: 10000  # 10 seconds

source:
  type: "kinesis"
  config:
    stream: "user-events"
    region: "us-west-2"
    initialPosition: "LATEST"
    
transformations:
  - name: "Parse Events"
    type: "deserialize"
    format: "json"
    schema:
      type: "object"
      properties:
        user_id:
          type: "string"
        event_time:
          type: "long"
          format: "unix-timestamp"
        product_id:
          type: "string"
        category:
          type: "string"
        value:
          type: "double"
        
  - name: "Product Window"
    type: "window"
    keyByProperties:
      field: "category"
    windowConfig:
      windowType: SLIDING
      size: 3600  # 1 hour in seconds
      slide: 60   # 1 minute in seconds
      timeUnit: SECONDS
      maxElementsPerWindow: 10000
      aggregateRules:
        - name: total_value
          field: value
          operation: sum
          fieldType: double
        - name: avg_value
          field: value
          operation: avg
          fieldType: double
        - name: unique_products
          field: product_id
          operation: count
          fieldType: long
          distinct: true
        - name: unique_users
          field: user_id
          operation: count
          fieldType: long
          distinct: true
        
sink:
  type: "s3"
  config:
    bucket: "analytics-results"
    path: "product-analytics"
    format: "parquet"
    partitioning:
      - field: "year"
        extractFromTimestamp: "window_end"
      - field: "month"
        extractFromTimestamp: "window_end"
      - field: "day"
        extractFromTimestamp: "window_end"
    compression: "snappy"
```

## Configuration Explanation

### Source Configuration
- Reads user events from Kinesis
- Configures for real-time processing
- Handles late-arriving data with watermarks

### Transformations
1. **Parse Events**: JSON deserialization with schema validation
2. **Product Window**: 
   - 1-hour sliding windows with 1-minute slides
   - Keyed by product category
   - Multiple aggregations per window

### Sink Configuration
- Writes to S3 in Parquet format
- Time-based partitioning
- Optimized for analytics queries 